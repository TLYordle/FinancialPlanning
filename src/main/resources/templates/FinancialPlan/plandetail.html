<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Plan System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<body class="bg-gray-200">
<script src="../js/logout.js" type="text/javascript"></script>

<div class="bg-gray-300 p-4 flex justify-between items-center">
    <div class="flex items-center">
        <span class="text-lg font-bold">FINANCIAL PLAN SYSTEM</span>
    </div>
    <div class="flex items-center">
        <div class="text-right mr-2">
            <span id = "full_name" class="block">tranglth</span>
            <span id = "role" class="text-sm text-gray-600">Accounting depart</span>
        </div>
        <i class="fas fa-user ml-2"></i>
        <button onclick="logout()" class="bg-gray-500 text-white p-2 ml-4">Logout</button>
    </div>
</div>
<div class="bg-gray-400 p-2 flex justify-between items-center">
    <nav class="flex space-x-4">
        <a class="text-black homePage" href="../Admin/home_admin.html">Home</a>
        <a class="text-black font-bold" href="#">Financial plan</a>
        <a class="text-black" href="../Report/monthly_report_staff.html">Financial Report</a>
        <a class="text-black" href="../Term/listTerm.html">Term Management</a>
        <a class="text-black userPage" href="../Admin/list_user.html">User Management</a>
    </nav>
</div>
<div class="p-4">
    <div class="bg-white p-4 shadow-md">
        <h2 class="text-xl font-bold">Financial Plan</h2>
        <p class="text-gray-600"><a href="#" class="text-blue-500">Plan List</a> &gt; Plan Details</p>
        <div class="grid grid-cols-2 gap-4 mt-4">
            <div class="bg-gray-100 p-4">
                <p class="font-bold">Plan:</p> <p id="PlanName"></p>
                <p class="font-bold">Term:     <p id="TermName"></p>
                <p class="font-bold">Department:</p> <p id ="Department"></p>
                <p class="font-bold">Status:</p> <p id="Status"></p>
            </div>
            <div class="bg-gray-100 p-4">
                <p class="font-bold">Uploaded by: </p> <p id="username"></p>
                <p class="font-bold">Plan Due date: </p> <p id="dueDate"></p>
                <p class="font-bold">Date:</p> <p id="Date"></p>
                <p class="font-bold">Version: </p> <p id="version"></p>
            </div>
        </div>
        <div class="mt-4 p-4 bg-gray-100">
            <p class="font-bold">Total plan:</p> <p id="total-sum"></p>
        </div>
        <div class="mt-4 flex justify-end space-x-2">
            <button class="bg-gray-300 text-black px-4 py-2 rounded">Reup</button>
            <button id="BExport" class="bg-gray-300 text-black px-4 py-2 rounded">Export</button>
        </div>
        <div class="mt-4 overflow-x-auto">
            <table class="min-w-full bg-white" id="PlansTabledetail">
                <thead>
                <tr>
                    <th class="px-4 py-2 border">No.</th>
                    <th class="px-4 py-2 border">Expense</th>
                    <th class="px-4 py-2 border">Cost type</th>
                    <th class="px-4 py-2 border">Unit Price (VND)</th>
                    <th class="px-4 py-2 border">Amount</th>
                    <th class="px-4 py-2 border">Total (VND)</th>
                    <th class="px-4 py-2 border">Project name</th>
                    <th class="px-4 py-2 border">Notes</th>
                    <th class="px-4 py-2 border">Expense Status</th>
                </tr>
                </thead>
                <tbody>

                </tbody>
            </table>
        </div>
        <div class="mt-4 flex justify-between items-center">
            <button class="bg-gray-300 text-black px-4 py-2 rounded"><a href="Plan_list.html">Back</a></button>
        </div>
    </div>
</div>
<script src="../js/plandetail.js"></script>
<script>
    var fullName = localStorage.getItem("full_name")
    var role = localStorage.getItem("role")
    var span = document.getElementById("full_name")
    var spanRole = document.getElementById("role")
    span.textContent = fullName
    spanRole.textContent = role
</script>
<script>
    // Lấy ngày hiện tại
    var today = new Date();

    // Định dạng ngày tháng
    var options = { year: 'numeric', month: 'long', day: 'numeric' };
    var formattedDate = today.toLocaleDateString('vi-VN', options);

    // Cập nhật nội dung của thẻ p
    document.getElementById("Date").innerText = formattedDate;
</script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const exportButton = document.getElementById("BExport"); // Sử dụng id của nút

        if (exportButton) {
            exportButton.addEventListener("click", function () {
                exportTableToExcel();
            });
        }
    });

    function exportTableToExcel() {
        let table = document.getElementById("PlansTabledetail");
        let ws = XLSX.utils.table_to_sheet(table); // Chuyển đổi bảng thành worksheet
        let wb = XLSX.utils.book_new();

        XLSX.utils.book_append_sheet(wb, ws, "Report Details");

        // Xuất file Excel với tên "Financial_Plan_Details.xlsx"
        XLSX.writeFile(wb, "Financial_Plan_Details.xlsx");
    }
</script>
</body>
</html>