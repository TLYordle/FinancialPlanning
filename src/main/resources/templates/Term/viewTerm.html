<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Term Details</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
</head>
<body class="bg-gray-200">
<script src="../js/logout.js" type="text/javascript"></script>

<div class="bg-gray-300 p-4 flex justify-between items-center">
    <div class="flex items-center">
        <span class="text-lg font-bold">FINANCIAL PLAN SYSTEM</span>
    </div>
    <div class="flex items-center">
        <div class="text-right mr-2">
            <span id = "full_name" class="block">tranglth</span>
            <span id = "role"class="text-sm text-gray-600">Accounting depart</span>
        </div>
        <i class="fas fa-user ml-2"></i>
        <button onclick="logout()" class="bg-gray-500 text-white p-2 ml-4">Logout</button>
    </div>
</div>
<div class="bg-gray-400 p-2 flex justify-between items-center">
    <nav class="flex space-x-4">
        <a class="text-black" href="../Admin/home_admin.html">Home</a>
        <a class="text-black" href="#">Financial plan</a>
        <a class="text-black" href="../Report/monthly_report_staff.html">Financial Report</a>
        <a class="text-black font-bold" href="listTerm.html">Term Management</a>
        <a class="text-black" href="../Admin/list_user.html">User Management</a>
    </nav>
</div>

<!--Body-->
<div class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-lg m-5">
    <h2 class="text-2xl font-bold mb-4">Term Management</h2>
    <a href="listTerm.html" class="text-blue-600 underline">Term List</a> > <span class="text-gray-700">Term Details</span>

    <div class="bg-gray-100 p-6 rounded-lg mt-4">
        <div class="grid grid-cols-2 gap-4">
            <div>
                <p class="font-bold">Term name</p>
                <p id="termName"></p>
            </div>
            <div>
                <p class="font-bold">Duration</p>
                <p id="duration"></p>
            </div>
            <div>
                <p class="font-bold">Start date</p>
                <p id="startDate"></p>
            </div>
            <div>
                <p class="font-bold">End date</p>
                <p id="endDate"></p>
            </div>
            <div>
                <p class="font-bold">Plan due date</p>
                <p id="planDueDate"></p>
            </div>
            <div>
                <p class="font-bold">Report due date</p>
                <p id="reportDueDate"></p>
            </div>
            <div>
                <p class="font-bold">Status</p>
                <p id="status"></p>
            </div>
        </div>

        <div class="mt-6 flex justify-center space-x-4">
            <button onclick="goBack()" class="bg-gray-500 text-white px-4 py-2 rounded">Back</button>
            <button onclick="editTerm()" class="bg-gray-700 text-white px-4 py-2 rounded">Edit</button>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", async function () {
        const urlParams = new URLSearchParams(window.location.search);
        const termId = urlParams.get("termId");

        if (!termId) {
            alert("Term ID not found!");
            return;
        }

        try {
            let response = await fetch(`http://localhost:8080/api/terms/${termId}`);
            let term = await response.json();

            document.getElementById("termName").innerText = term.termName;
            document.getElementById("duration").innerText = term.duration || "N/A";
            document.getElementById("startDate").innerText = new Date(term.startDate).toLocaleDateString();
            document.getElementById("endDate").innerText = new Date(term.endDate).toLocaleDateString();
            document.getElementById("planDueDate").innerText = new Date(term.planDueDate).toLocaleDateString();
            document.getElementById("reportDueDate").innerText = new Date(term.reportDueDate).toLocaleDateString();
            document.getElementById("status").innerText = term.status;
        } catch (error) {
            console.error("Error fetching term details:", error);
            alert("Failed to load term details.");
        }
    });

    function goBack() {
        window.history.back();
    }

    function editTerm() {
        const urlParams = new URLSearchParams(window.location.search);
        const termId = urlParams.get("termId");
        window.location.href = `editTerm.html?termId=${termId}`;
    }
</script>
<script>
    var fullName = localStorage.getItem("full_name")
    var role = localStorage.getItem("role")
    var span = document.getElementById("full_name")
    var spanRole = document.getElementById("role")
    span.textContent = fullName
    spanRole.textContent = role
</script>
</body>
</html>
